<!DOCTYPE html><html lang="zh-CN"><head><meta name="x-poe-datastore-behavior" content="local_only"><meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' 'unsafe-eval' data: blob: https://cdnjs.cloudflare.com https://cdn.jsdelivr.net https://code.jquery.com https://unpkg.com https://d3js.org https://threejs.org https://cdn.plot.ly https://stackpath.bootstrapcdn.com https://maps.googleapis.com https://cdn.tailwindcss.com https://ajax.googleapis.com https://kit.fontawesome.com https://cdn.datatables.net https://maxcdn.bootstrapcdn.com https://code.highcharts.com https://tako-static-assets-production.s3.amazonaws.com https://www.youtube.com https://fonts.googleapis.com https://fonts.gstatic.com https://pfst.cf2.poecdn.net https://puc.poecdn.net https://i.imgur.com https://wikimedia.org https://*.icons8.com https://*.giphy.com https://picsum.photos https://images.unsplash.com; frame-src 'self' https://www.youtube.com https://trytako.com; child-src 'self'; manifest-src 'self'; worker-src 'self'; upgrade-insecure-requests; block-all-mixed-content;">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>入门试学班上课时间表</title>
<style>
  :root{
    --bg:#1b1c22;
    --panel:#262833;
    --card:#323544;
    --muted:#aab0bf;
    --text:#eef0f4;
    --accent:#ff4f71;
    --accent-weak:#ff4f7133;
    --good:#52d273;
    --warn:#f0c36a;
    --shadow:0 10px 30px rgba(0,0,0,.45);
    --radius-lg:14px;
    --radius-md:10px;
  }
  html,body{height:100%}
  body{
    margin:0;
    background:radial-gradient(1200px 800px at 20% -10%,#20222b 0%,#1b1c22 60%),var(--bg);
    color:var(--text);
    font-family: ui-sans-serif,system-ui,-apple-system,"Segoe UI","Helvetica Neue",Arial,"PingFang SC","Hiragino Sans GB","Noto Sans CJK SC","Microsoft YaHei",sans-serif;
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
    line-height:1.6;
  }
  .wrap{
    max-width:1200px;
    margin:0 auto;
    padding:28px 18px 40px;
  }
  header{
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:12px;
    margin-bottom:18px;
  }
  h1{
    margin:0;
    font-size: clamp(20px, 2.6vw, 32px);
    font-weight:800;
    letter-spacing:.3px;
    color:var(--accent);
  }
  .now-card{
    background:linear-gradient(180deg,#2a2d3a 0%, #262833 100%);
    border-radius:var(--radius-lg);
    box-shadow:var(--shadow);
    padding:14px 16px;
    display:grid;
    grid-template-columns:1.1fr auto auto;
    gap:12px;
    align-items:center;
  }
  .now-left{
    min-width:0;
  }
  .now-title{
    font-size:clamp(14px,1.4vw,16px);
    color:var(--muted);
    margin-bottom:4px;
  }
  .now-main{
    display:flex;align-items:baseline;gap:10px;flex-wrap:wrap;
  }
  .now-name{
    font-weight:700;
    font-size:clamp(18px,2vw,22px);
    color:#fff;
  }
  .now-time{
    font-weight:600;
    color:var(--accent);
    font-size:clamp(14px,1.5vw,16px);
    padding:2px 10px;
    border-radius:999px;
    background:var(--accent-weak);
  }
  .clock{
    font-variant-numeric:tabular-nums;
    font-weight:700;
    font-size:clamp(18px,2vw,22px);
    color:#fff;
    text-align:right;
    min-width:140px;
  }
  .badge{
    justify-self:end;
    padding:6px 10px;
    border-radius:999px;
    font-size:12px;
    font-weight:700;
    letter-spacing:.3px;
    background:#3a3d4d;
    color:#d5d9e6;
  }
  .grid{
    display:grid;
    grid-template-columns:1fr 1fr;
    gap:22px;
    align-items:start;
    margin-top:18px;
  }
  @media (max-width: 900px){
    .now-card{grid-template-columns:1fr auto;grid-auto-flow:row;}
    .badge{justify-self:start}
    .grid{grid-template-columns:1fr}
  }
  .schedule{
    background:var(--panel);
    border-radius:var(--radius-lg);
    box-shadow:var(--shadow);
    padding:20px;
    display:flex;
    flex-direction:column;
    min-height:100%;
  }
  .schedule header{
    margin:0 0 14px 0;
    padding:0 0 10px 0;
    border-bottom:1px dashed #3a3d4d;
  }
  .schedule h2{
    margin:0;
    font-size:clamp(16px,1.8vw,20px);
    color:#fff;
    font-weight:700;
    letter-spacing:.2px;
  }
  .timeline{
    position:relative;
    display:flex;
    flex-direction:column;
    gap:10px;
    padding-left:14px;
    margin-top:8px;
  }
  .timeline::before{
    content:"";
    position:absolute;
    left:5px;
    top:0;bottom:0;
    width:2px;
    background:linear-gradient(#3a3d4d,#3a3d4d);
    opacity:.6;
  }
  .item{
    position:relative;
    background:var(--card);
    border-radius:var(--radius-md);
    padding:12px 14px 12px 14px;
    display:grid;
    grid-template-columns:auto 1fr auto;
    gap:10px 12px;
    align-items:center;
    outline:1px solid rgba(255,255,255,.04);
    transition:transform .18s ease, outline-color .18s ease, background .18s ease, box-shadow .18s ease;
  }
  .item::before{
    content:"";
    position:absolute;
    left:-11px;
    top:16px;
    width:10px;height:10px;border-radius:50%;
    background:#737a8c;
    box-shadow:0 0 0 3px #2b2e3a inset;
  }
  .label{
    color:#fff;
    font-weight:600;
    font-size:14px;
  }
  .time{
    justify-self:end;
    color:var(--accent);
    font-weight:700;
    font-variant-numeric:tabular-nums;
    font-size:14px;
  }
  .meta{
    grid-column:1 / -1;
    color:var(--muted);
    font-size:12px;
  }
  .break{
    background:#2f3140;
    color:#d8dae3;
  }
  .break .time{color:#d8dae3}
  .current{
    background:linear-gradient(180deg,#3a3d4d 0%, #35384a 100%);
    outline-color:var(--accent);
    box-shadow:0 8px 24px rgba(255,79,113,.15);
    transform:translateZ(0) scale(1.01);
  }
  .current::before{
    background:var(--accent);
    box-shadow:0 0 0 6px rgba(255,79,113,.18);
  }
  .between{
    position:relative;
    overflow:hidden;
  }
  .between::after{
    content:"";
    position:absolute;
    left:0;top:0;bottom:0;
    width:var(--progress,0%);
    background:linear-gradient(90deg, rgba(255,79,113,.12), rgba(255,79,113,0));
    pointer-events:none;
  }
  .progressbar{
    grid-column:1 / -1;
    height:6px;
    background:#2a2c39;
    border-radius:999px;
    overflow:hidden;
  }
  .progressbar span{
    display:block;height:100%;
    width:var(--p,0%);
    background:linear-gradient(90deg,var(--accent),#ff7a92);
    border-radius:999px;
    transition:width .3s ease;
  }
  .footer-note{
    margin-top:auto;
    color:var(--muted);
    font-size:12px;
    text-align:center;
    padding-top:14px;
    border-top:1px dashed #3a3d4d;
  }
  .pill{
    display:inline-flex;align-items:center;gap:8px;
    background:#2f3140;color:#e9ebf3;padding:6px 10px;border-radius:999px;font-size:12px;font-weight:700;
  }
  .pill .dot{width:8px;height:8px;border-radius:50%;background:var(--good)}
  .ghost{opacity:.75}
</style>
<script src="https://puc.poecdn.net/authenticated_preview_page/syncedState.bd4eeeb8e8e02052ee92.js"></script></head>
<body>
<div class="wrap">
  <header>
    <h1>入门试学班上课时间表</h1>
    <div class="pill"><span class="dot"></span><span id="statusText">状态计算中</span></div>
  </header>

  <section class="now-card" id="nowCard">
    <div class="now-left">
      <div class="now-title">当前状态</div>
      <div class="now-main">
        <div class="now-name" id="nowName">加载中...</div>
        <div class="now-time" id="nowRange">—</div>
      </div>
    </div>
    <div class="clock" id="clock">--:--:--</div>
    <div class="badge" id="dayType">正常日</div>
  </section>

  <section class="grid">
    <div class="schedule" id="normalDay">
      <header><h2>正常日</h2></header>
      <div class="timeline" id="normalTimeline"></div>
      <div class="footer-note">备注：老师可根据当日进度灵活调整时间</div>
    </div>
    <div class="schedule" id="studyDay">
      <header><h2>自习日</h2></header>
      <div class="timeline" id="studyTimeline"></div>
      <div class="footer-note ghost">提示：自习日与正常日安排不同，请提前留意</div>
    </div>
  </section>
</div>

<script>
  const accent = getComputedStyle(document.documentElement).getPropertyValue('--accent').trim();

  const normalData = [
    { name:"点名 & 早读",    start:"08:40", end:"08:55", kind:"session" },
    { name:"第一节课",       start:"09:00", end:"09:50", kind:"class" },
    { name:"第二节课",       start:"10:00", end:"10:50", kind:"class" },
    { name:"第三节课",       start:"11:00", end:"12:00", kind:"class" },
    { name:"午休",           start:"12:00", end:"14:00", kind:"break" },
    { name:"点名 & 演讲",    start:"14:10", end:"14:25", kind:"session" },
    { name:"第四节课",       start:"14:30", end:"15:20", kind:"class" },
    { name:"第五节课",       start:"15:30", end:"16:20", kind:"class" },
    { name:"第六节课",       start:"16:30", end:"17:30", kind:"class" },
    { name:"晚自习（第一节）", start:"18:30", end:"19:20", kind:"self" },
    { name:"晚自习（第二节）", start:"19:30", end:"20:20", kind:"self" },
    { name:"晚自习（第三节）", start:"20:30", end:"21:30", kind:"self" },
    { name:"打扫卫生",       start:"21:30", end:"22:00", kind:"duty" },
    { name:"离校",           start:"22:00", end:"22:15", kind:"leave" }
  ];

  const studyData = [
    { name:"上午点名",     start:"09:50", end:"09:50", kind:"session" },
    { name:"第一节课",     start:"09:50", end:"10:50", kind:"class" },
    { name:"第二节课",     start:"11:00", end:"11:50", kind:"class" },
    { name:"下午点名",     start:"14:25", end:"14:25", kind:"session" },
    { name:"第三节课",     start:"14:25", end:"15:30", kind:"class" },
    { name:"第四节课",     start:"15:40", end:"16:40", kind:"class" },
    { name:"第五节课",     start:"16:50", end:"17:30", kind:"class" }
  ];

  function parseHM(hm){
    const [h,m]=hm.split(":").map(Number);
    const d=new Date();
    d.setHours(h,m||0,0,0);
    return d;
  }

  function inRange(now, s, e){
    return now>=s && now<=e;
  }

  function progress(now,s,e){
    const dur=e-s;
    if(dur<=0) return 1;
    return Math.min(1, Math.max(0, (now - s) / dur));
  }

  function createItem(entry){
    const el=document.createElement('div');
    el.className='item';
    if(entry.kind==='break') el.classList.add('break');
    const label=document.createElement('div');
    label.className='label';
    label.textContent=entry.name;
    const time=document.createElement('div');
    time.className='time';
    time.textContent=`${entry.start}${entry.end && entry.end!==entry.start ? ' - '+entry.end : ''}`;
    el.appendChild(label);
    el.appendChild(document.createElement('div'));
    el.appendChild(time);
    const meta=document.createElement('div');
    meta.className='meta';
    meta.textContent=tagText(entry.kind);
    el.appendChild(meta);
    const prog=document.createElement('div');
    prog.className='progressbar';
    const bar=document.createElement('span');
    prog.appendChild(bar);
    el.appendChild(prog);
    return {el,bar};
  }

  function tagText(kind){
    switch(kind){
      case 'class': return '课程';
      case 'self': return '晚自习';
      case 'break': return '休息';
      case 'duty': return '整理';
      case 'leave': return '离校';
      case 'session': return '活动';
      default: return '安排';
    }
  }

  function interleaveWithBreaks(list){
    const result=[];
    for(let i=0;i<list.length;i++){
      result.push(list[i]);
      const a=list[i], b=list[i+1];
      if(!b) break;
      const aEnd=parseHM(a.end), bStart=parseHM(b.start);
      if(bStart - aEnd > 60*1000){
        result.push({name:"课间/空档", start:fmtTime(aEnd), end:fmtTime(bStart), kind:"break", synthetic:true});
      }
    }
    return result;
  }

  function fmtTime(d){
    const hh=String(d.getHours()).padStart(2,'0');
    const mm=String(d.getMinutes()).padStart(2,'0');
    return `${hh}:${mm}`;
  }

  function buildTimeline(container, data){
    container.innerHTML='';
    const enriched = interleaveWithBreaks(data);
    const nodes=[];
    enriched.forEach(entry=>{
      const {el,bar}=createItem(entry);
      container.appendChild(el);
      nodes.push({entry, el, bar});
    });
    return nodes;
  }

  const normalNodes = buildTimeline(document.getElementById('normalTimeline'), normalizeData(normalData));
  const studyNodes  = buildTimeline(document.getElementById('studyTimeline'), normalizeData(studyData));

  function normalizeData(arr){
    return arr.map(o=>{
      const start = parseHM(o.start);
      const end = o.end ? parseHM(o.end) : parseHM(o.start);
      return {...o, _start:start, _end:end};
    });
  }

  function decideDayType(now){
    const dow=now.getDay();
    return (dow===0 || dow===6) ? '自习日' : '正常日';
  }

  function update(){
    const now=new Date();
    document.getElementById('clock').textContent=now.toLocaleTimeString('zh-CN',{hour12:false});
    const dayType=decideDayType(now);
    document.getElementById('dayType').textContent=dayType;

    const datasets = {
      '正常日': normalNodes,
      '自习日': studyNodes
    };
    const nodes = datasets[dayType];

    let anyCurrent=false, currentInfo=null;

    function paint(nodes){
      nodes.forEach(node=>{
        const s = parseHM(node.entry.start);
        const e = parseHM(node.entry.end || node.entry.start);
        const active = inRange(now, s, e);
        const p = progress(now, s, e);
        node.el.classList.toggle('current', active && node.entry.kind!=='break');
        node.el.classList.toggle('between', !active && now>s && now<e);
        node.bar.style.setProperty('--p', (active? p*100 : (now>e?100:0)) + '%');
        if(active){
          anyCurrent=true;
          currentInfo = node.entry;
        }
        if(node.entry.kind==='break'){
          const perc = active ? p*100 : (now>e?100: (now<s?0: p*100));
          node.el.style.setProperty('--progress', perc + '%');
        }
      });
    }

    paint(normalNodes);
    paint(studyNodes);

    const nowName = document.getElementById('nowName');
    const nowRange = document.getElementById('nowRange');
    const statusText = document.getElementById('statusText');
    const nowCard = document.getElementById('nowCard');

    let globalState = { title:'非在校时间', name:'当前不在在校时段', range:'—', status:'离校' };

    const normalBounds = boundsOf(normalData);
    const studyBounds  = boundsOf(studyData);

    const withinNormal = now >= normalBounds.s && now <= normalBounds.e;
    const withinStudy  = now >= studyBounds.s && now <= studyBounds.e;

    if(dayType==='正常日'){
      if(anyCurrent && nodes===normalNodes){
        globalState = { title:'进行中', name: currentInfo.name, range: `${currentInfo.start}${currentInfo.end && currentInfo.end!==currentInfo.start ? ' - '+currentInfo.end : ''}`, status:'正常日' };
      }else if(withinNormal){
        const next = nextSlot(normalData, now);
        globalState = { title:'课间 / 空档', name: next? `即将：${next.name}` : '今日安排已结束', range: next? `${next.start} - ${next.end}` : '—', status:'正常日' };
      }
    }else{
      if(anyCurrent && nodes===studyNodes){
        globalState = { title:'进行中', name: currentInfo.name, range: `${currentInfo.start}${currentInfo.end && currentInfo.end!==currentInfo.start ? ' - '+currentInfo.end : ''}`, status:'自习日' };
      }else if(withinStudy){
        const next = nextSlot(studyData, now);
        globalState = { title:'课间 / 空档', name: next? `即将：${next.name}` : '今日安排已结束', range: next? `${next.start} - ${next.end}` : '—', status:'自习日' };
      }
    }

    nowName.textContent = globalState.name;
    nowRange.textContent = globalState.range;
    statusText.textContent = globalState.title;
    nowCard.querySelector('.badge').textContent = globalState.status;

    equalizeHeights();
    requestAnimationFrameTick();
  }

  function boundsOf(arr){
    const s=parseHM(arr[0].start);
    const e=parseHM(arr[arr.length-1].end || arr[arr.length-1].start);
    return {s,e};
  }

  function nextSlot(arr, now){
    for(const e of arr){
      const s=parseHM(e.start);
      if(now<s) return e;
    }
    return null;
  }

  function equalizeHeights(){
    const a=document.getElementById('normalDay');
    const b=document.getElementById('studyDay');
    if(window.matchMedia('(max-width: 900px)').matches){
      a.style.minHeight='unset';
      b.style.minHeight='unset';
      return;
    }
    a.style.minHeight='0px'; b.style.minHeight='0px';
    const h=Math.max(a.offsetHeight, b.offsetHeight);
    a.style.minHeight=h+'px';
    b.style.minHeight=h+'px';
  }

  let rafId=null, lastSec=null;
  function tick(){
    const now=new Date();
    const sec=now.getSeconds();
    if(sec!==lastSec){
      lastSec=sec;
      update();
    }
    rafId=requestAnimationFrame(tick);
  }
  function requestAnimationFrameTick(){
    if(rafId) return;
    rafId=requestAnimationFrame(tick);
  }

  window.addEventListener('resize', equalizeHeights);

  function init(){
    update();
    equalizeHeights();
  }
  init();
</script>


</body></html>